@this()

@(principal: viewmodels.Principal, departureOfficeTrimmed: String, acceptanceDateFormatted: Option[String], transitOffices: Seq[CustomsOfficeOfTransit] = Nil)

<fo:table width="100%" table-layout="fixed"> <!-- S1 TABLE 4 -->
    <fo:table-column column-width="16mm" column-number="1"/>
    <fo:table-column column-width="122.64mm" column-number="2"/>
    <fo:table-column column-width="61.32mm" column-number="3"/>
    <fo:table-body>
        <fo:table-row height="18.75mm"> <!-- S1 T4 ROW 1 -->
            <fo:table-cell border-top-color="black" border-top-width="1pt" border-top-style="solid">
                <fo:block/>
            </fo:table-cell>
            <fo:table-cell border-style="solid" border-width="1pt" border-color="black" number-rows-spanned="2">
                <fo:block>
                    <fo:table width="100%" table-layout="fixed">
                        <fo:table-column column-width="45mm"/>
                        <fo:table-column column-width="6mm"/>
                        <fo:table-column column-width="33.36mm"/>
                        <fo:table-column column-width="10mm"/>
                        <fo:table-column column-width="33mm"/>
                        <fo:table-body>
                            <fo:table-row height="6.25mm">
                                <fo:table-cell padding-left="2mm" display-align="center">
                                    <fo:block>Principal/TIR Holder (50)</fo:block>
                                </fo:table-cell>
                                <fo:table-cell padding-left="2mm" display-align="center">
                                    <fo:block>No</fo:block>
                                </fo:table-cell>
                                <fo:table-cell padding-left="2mm" display-align="center" font-weight="bold">
                                    <fo:block>
                                        <!--output eori/tirid or eori-->
                                        @if(principal.tir.nonEmpty && principal.eori.nonEmpty) {
                                            @principal.eori.map(x => x) / @principal.tir.map(x => x)
                                        } else {
                                            @principal.eori.map(x => x)
                                        }
                                    </fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                            <fo:table-row height="6.25mm">
                                <fo:table-cell number-columns-spanned="5" padding-left="2mm" display-align="center" font-weight="bold">
                                    <fo:block>
                                        @principal.name
                                    </fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                            <fo:table-row height="6.25mm">
                                <fo:table-cell number-columns-spanned="2" padding-left="2mm" display-align="center" font-weight="bold">
                                    <fo:block>
                                        @principal.streetAndNumberTrimmed
                                    </fo:block>
                                </fo:table-cell>
                                <fo:table-cell number-columns-spanned="3" padding-left="2mm" display-align="center" font-weight="bold">
                                    <fo:block>
                                        @principal.postCode
                                    </fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                            <fo:table-row height="6.25mm">
                                <fo:table-cell number-columns-spanned="2" padding-left="2mm" display-align="center" font-weight="bold">
                                    <fo:block>
                                        @principal.city
                                    </fo:block>
                                </fo:table-cell>
                                <fo:table-cell number-columns-spanned="3" padding-left="2mm" display-align="center" font-weight="bold">
                                    <fo:block>
                                        @principal.country.code
                                    </fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                        </fo:table-body>
                    </fo:table>
                </fo:block>
            </fo:table-cell>
            <fo:table-cell border-top-style="solid" border-top-width="0.5pt" border-top-color="black" border-bottom-style="solid" border-bottom-width="1pt" border-bottom-color="black" number-rows-spanned="2">
                <fo:block>
                    <fo:table width="100%" table-layout="fixed">
                        <fo:table-column/>
                        <fo:table-body>
                            <fo:table-row height="3.6875mm">
                                <fo:table-cell padding-left="2mm" display-align="center">
                                    <fo:block>C OFFICE OF DEPARTURE</fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                            <fo:table-row height="3.6875mm">
                                <fo:table-cell padding-left="2mm" display-align="center" font-weight="bold">
                                    <fo:block>
                                        @departureOfficeTrimmed
                                    </fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                            <fo:table-row height="3.6875mm">
                                <fo:table-cell padding-left="2mm" display-align="center" font-weight="bold">
                                    <fo:block/>
                                </fo:table-cell>
                            </fo:table-row>
                            <fo:table-row height="3.6875mm">
                                <fo:table-cell padding-left="2mm" display-align="center" font-weight="bold">
                                    <fo:block>
                                        @acceptanceDateFormatted
                                    </fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                            <fo:table-row height="12mm">
                                <fo:table-cell padding-left="2mm" padding-top="1mm" font-weight="bold">
                                    <fo:block/>
                                </fo:table-cell>
                            </fo:table-row>
                        </fo:table-body>
                    </fo:table>
                </fo:block>
            </fo:table-cell>
        </fo:table-row>
        <fo:table-row height="8mm"> <!-- S1 T4 ROW 2 -->
            <fo:table-cell number-rows-spanned="2" padding-top="1mm" border-top-style="solid" border-top-width="1pt" border-top-color="black">
                <fo:block>
                    <fo:list-block>
                        <fo:list-item>
                            <fo:list-item-label>
                                <fo:block>
                                    51
                                </fo:block>
                            </fo:list-item-label>
                            <fo:list-item-body start-indent="3mm" end-indent="0mm">
                                <fo:block wrap-option="wrap">Intended offices of transit (and country)</fo:block>
                            </fo:list-item-body>
                        </fo:list-item>
                    </fo:list-block>
                </fo:block>
            </fo:table-cell>
        </fo:table-row>
        <fo:table-row height="8mm"> <!-- S1 T4 ROW 3 -->
            <fo:table-cell number-columns-spanned="2" column-number="2" padding-top="0.5mm">
                <fo:block>
                    <fo:table width="100%" table-layout="fixed">
                        <fo:table-column column-width="30.66mm"/>
                        <fo:table-column column-width="30.66mm"/>
                        <fo:table-column column-width="30.66mm"/>
                        <fo:table-column column-width="30.66mm"/>
                        <fo:table-column column-width="30.66mm"/>
                        <fo:table-column column-width="30.66mm"/>
                        <fo:table-body>
                            <fo:table-row height="7.5mm">
                                @for(i <- 1 to 6){
                                    <fo:table-cell border-left-color="black" border-left-style="solid" border-left-width="1pt" display-align="center" font-weight="bold" padding-left="2mm">
                                        @if(transitOffices.isDefinedAt(i)) {
                                            <fo:block>
                                                <fo:inline font-style="italic">
                                                    @transitOffices(i).reference
                                                </fo:inline>
                                            </fo:block>
                                            <fo:block>
                                                <fo:inline font-style="italic">
                                                    @transitOffices(i).formattedDate
                                                </fo:inline>
                                            </fo:block>
                                        } else {
                                            <fo:block/>
                                        }
                                    </fo:table-cell>
                                }
                            </fo:table-row>
                        </fo:table-body>
                    </fo:table>
                </fo:block>
            </fo:table-cell>
        </fo:table-row>
        <fo:table-row height="8mm"> <!-- S1 T4 ROW 4 -->
            <fo:table-cell>
                <fo:block>
                    <fo:list-block>
                        <fo:list-item>
                            <fo:list-item-label>
                                <fo:block>
                                    52
                                </fo:block>
                            </fo:list-item-label>
                            <fo:list-item-body start-indent="3mm" end-indent="0mm">
                                <fo:block wrap-option="wrap">Guarantee not valid for</fo:block>
                            </fo:list-item-body>
                        </fo:list-item>
                    </fo:list-block>
                </fo:block>
            </fo:table-cell>
            <fo:table-cell border-right-style="solid" border-right-width="1pt" border-right-color="black" border-top-style="solid" border-top-width="1pt" border-top-color="black">
                <fo:table width="100%" table-layout="fixed">
                    <fo:table-column column-width="114.64mm"/>
                    <fo:table-column column-width="8mm"/>
                    <fo:table-body>
                        <fo:table-row height="2mm">
                            <fo:table-cell number-rows-spanned="2">
                                <fo:block>
                                    <fo:table width="100%" table-layout="fixed">
                                        <fo:table-column column-width="38.213mm"/>
                                        <fo:table-column column-width="38.213mm"/>
                                        <fo:table-column column-width="38.213mm"/>
                                        <fo:table-body>
                                            <fo:table-row height="2mm">
                                                <fo:table-cell>
                                                    <fo:block/>
                                                </fo:table-cell>
                                            </fo:table-row>
                                            <fo:table-row height="2mm">
                                                <fo:table-cell>
                                                    <fo:block/>
                                                </fo:table-cell>
                                            </fo:table-row>
                                        </fo:table-body>
                                    </fo:table>
                                </fo:block>
                            </fo:table-cell>
                            <fo:table-cell text-align="center" display-align="center">
                                <fo:block>Code</fo:block>
                            </fo:table-cell>
                        </fo:table-row>
                        <fo:table-row height="2mm">
                            <fo:table-cell display-align="center" border-left-style="solid" border-left-width="1pt" border-left-color="black" text-align="center">
                                <fo:block/>
                            </fo:table-cell>
                        </fo:table-row>
                    </fo:table-body>
                </fo:table>
            </fo:table-cell>
            <fo:table-cell border-top-style="solid" border-top-width="1pt" border-top-color="black">
                <fo:block>
                    <fo:table width="100%" table-layout="fixed">
                        <fo:table-column/>
                        <fo:table-body>
                            <fo:table-row height="2mm">
                                <fo:table-cell padding-left="2mm" display-align="center">
                                    <fo:block>53 Office of destination (and country)</fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                            <fo:table-row height="2mm">
                                <fo:table-cell text-align="center" display-align="center" font-weight="bold">
                                    <fo:block/>
                                </fo:table-cell>
                            </fo:table-row>
                        </fo:table-body>
                    </fo:table>
                </fo:block>
            </fo:table-cell>
        </fo:table-row>
    </fo:table-body>
</fo:table>